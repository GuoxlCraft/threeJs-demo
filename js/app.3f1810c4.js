(function(){var e={2078:function(e,n,t){"use strict";var i=t(4621),r=t(3895);function o(e,n){const t=(0,r.up)("router-link"),i=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("nav",null,[(0,r.Wm)(t,{to:"/"},{default:(0,r.w5)((()=>[(0,r.Uk)("Home")])),_:1}),(0,r.Uk)(" | "),(0,r.Wm)(t,{to:"/about"},{default:(0,r.w5)((()=>[(0,r.Uk)("About")])),_:1})]),(0,r.Wm)(i)],64)}var a=t(6004);const s={},u=(0,a.Z)(s,[["render",o]]);var l=u,m=t(8506),c=(t(817),t(6310)),d=t(9959),h=t(670),v=t(4487);new v.XS;const f=new d.xsS,g=(new d.cBK).setPath("./textures/"),p=g.load(["1.jpg","2.jpg","3.jpg","4.jpg","5.jpg","6.jpg"]);f.background=p,f.environment=p;var w=f;const x=new d.cPb(75,window.innerHeight/window.innerHeight,1,5e4);x.position.set(5,10,15);var y=x,S=t(1703);const T=new d.CP7({antialias:!0});T.setSize(window.innerWidth,window.innerHeight),T.shadowMap.enabled=!0;var b=T;const _=new S.z(y,b.domElement);_.enableDamping=!0;var P=_;const C=new d.y8_(5);var L=C;y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),window.addEventListener("resize",(()=>{y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),b.setSize(window.innerWidth,window.innerHeight),b.setPixelRatio(window.devicePixelRatio)}));var z=t(3659);function M(e){e.material.onBeforeCompile=n=>{n.fragmentShader=n.fragmentShader.replace("#include <dithering_fragment>","\n        #include <dithering_fragment>\n        //#end#\n    "),j(n,e),k(n),F(n),H(n)}}function j(e,n){n.geometry.computeBoundingBox();let{min:t,max:i}=n.geometry.boundingBox,r=i.y-t.y;e.uniforms.uTopColor={value:new d.Ilk("#aaaeff")},e.uniforms.uHeight={value:r},e.vertexShader=e.vertexShader.replace("#include <common>","\n      #include <common>\n      varying vec3 vPosition;\n      "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      vPosition = position;\n  "),e.fragmentShader=e.fragmentShader.replace("#include <common>","\n      #include <common>\n      \n      uniform vec3 uTopColor;\n      uniform float uHeight;\n      varying vec3 vPosition;\n\n        "),e.fragmentShader=e.fragmentShader.replace("//#end#","\n      \n      vec4 distGradColor = gl_FragColor;\n\n      // 设置混合的百分比\n      float gradMix = (vPosition.y+uHeight/2.0)/uHeight;\n      // 计算出混合颜色\n      vec3 gradMixColor = mix(distGradColor.xyz,uTopColor,gradMix);\n      gl_FragColor = vec4(gradMixColor,1);\n        //#end#\n\n      ")}function k(e,n=new d.FM8(0,0)){e.uniforms.uSpreadCenter={value:n},e.uniforms.uSpreadTime={value:-2e3},e.uniforms.uSpreadWidth={value:40},e.fragmentShader=e.fragmentShader.replace("#include <common>","\n      #include <common>\n\n      uniform vec2 uSpreadCenter;\n      uniform float uSpreadTime;\n      uniform float uSpreadWidth;\n      "),e.fragmentShader=e.fragmentShader.replace("//#end#","\n     float spreadRadius = distance(vPosition.xz,uSpreadCenter);\n    //  扩散范围的函数\n    float spreadIndex = -(spreadRadius-uSpreadTime)*(spreadRadius-uSpreadTime)+uSpreadWidth;\n\n    if(spreadIndex>0.0){\n        gl_FragColor = mix(gl_FragColor,vec4(1,1,1,1),spreadIndex/uSpreadWidth);\n    }\n\n    //#end#\n    "),h.ZP.to(e.uniforms.uSpreadTime,{value:800,duration:3,ease:"none",repeat:-1})}function F(e){e.uniforms.uLightLineTime={value:-1500},e.uniforms.uLightLineWidth={value:200},e.fragmentShader=e.fragmentShader.replace("#include <common>","\n        #include <common>\n  \n        \n        uniform float uLightLineTime;\n        uniform float uLightLineWidth;\n        "),e.fragmentShader=e.fragmentShader.replace("//#end#","\n      float LightLineMix = -(vPosition.x+vPosition.z-uLightLineTime)*(vPosition.x+vPosition.z-uLightLineTime)+uLightLineWidth;\n  \n      if(LightLineMix>0.0){\n          gl_FragColor = mix(gl_FragColor,vec4(0.8,1.0,1.0,1),LightLineMix /uLightLineWidth);\n          \n      }\n  \n      //#end#\n      "),h.ZP.to(e.uniforms.uLightLineTime,{value:1500,duration:5,ease:"none",repeat:-1})}function H(e){e.uniforms.uToTopTime={value:0},e.uniforms.uToTopWidth={value:40},e.fragmentShader=e.fragmentShader.replace("#include <common>","\n          #include <common>\n    \n          \n          uniform float uToTopTime;\n          uniform float uToTopWidth;\n          "),e.fragmentShader=e.fragmentShader.replace("//#end#","\n        float ToTopMix = -(vPosition.y-uToTopTime)*(vPosition.y-uToTopTime)+uToTopWidth;\n    \n        if(ToTopMix>0.0){\n            gl_FragColor = mix(gl_FragColor,vec4(0.8,0.8,1,1),ToTopMix /uToTopWidth);\n            \n        }\n    \n        //#end#\n        "),h.ZP.to(e.uniforms.uToTopTime,{value:500,duration:3,ease:"none",repeat:-1})}var W=t(3841),I=t.n(W),E=t(4778),O=t.n(E);class B{constructor(e={x:0,z:0},n=65535){let t=[new d.Pa4(0,0,0),new d.Pa4(e.x/2,4,e.z/2),new d.Pa4(e.x,0,e.z)];this.lineCurve=new d.YT8(t);const i=this.lineCurve.getPoints(1e3);this.geometry=(new d.u9r).setFromPoints(i);const r=new Float32Array(i.length);for(let o=0;o<r.length;o++)r[o]=o;this.geometry.setAttribute("aSize",new d.TlE(r,1)),this.shaderMaterial=new d.jyz({uniforms:{uTime:{value:0},uColor:{value:new d.Ilk(n)},uLength:{value:i.length}},vertexShader:I(),fragmentShader:O(),transparent:!0,depthWrite:!1,blending:d.WMw}),this.mesh=new d.woe(this.geometry,this.shaderMaterial),h.ZP.to(this.shaderMaterial.uniforms.uTime,{value:1e3,duration:2,repeat:-1,ease:"none"})}remove(){this.mesh.remove(),this.mesh.removeFromParent(),this.mesh.geometry.dispose(),this.mesh.material.dispose()}}class D{constructor(e){const n=new d.TOt(e);this.material=new d.nls({color:16777215});const t=new d.ejS(n,this.material);this.geometry=n,this.mesh=t}}var U=t(6167),Z=t.n(U),A=t(1063),K=t.n(A);class Y{constructor(e=5,n=2,t={x:0,z:0},i=16711680){this.geometry=new d.m_w(e,e,2,32,1,!0),this.material=new d.jyz({vertexShader:Z(),fragmentShader:K(),transparent:!0,side:d.ehD}),this.mesh=new d.Kj0(this.geometry,this.material),this.mesh.position.set(t.x,1,t.z),this.mesh.geometry.computeBoundingBox();let{min:r,max:o}=this.mesh.geometry.boundingBox,a=o.y-r.y;this.material.uniforms.uHeight={value:a},h.ZP.to(this.mesh.scale,{x:n,z:n,duration:1,repeat:-1,yoyo:!0})}remove(){this.mesh.remove(),this.mesh.removeFromParent(),this.mesh.geometry.dispose(),this.mesh.material.dispose()}}var R=t(6232),q=t.n(R),N=t(4008),G=t.n(N);class J{constructor(e=2,n={x:0,z:0},t=16711680){this.geometry=new d.BKK(e,e),this.material=new d.jyz({uniforms:{uColor:{value:new d.Ilk(t)},uTime:{value:0}},vertexShader:q(),fragmentShader:G(),transparent:!0,side:d.ehD}),this.mesh=new d.Kj0(this.geometry,this.material),this.mesh.position.set(n.x,1,n.z),this.mesh.rotation.x=-Math.PI/2,h.ZP.to(this.material.uniforms.uTime,{value:1,duration:1,repeat:-1,ease:"none"})}remove(){this.mesh.remove(),this.mesh.removeFromParent(),this.mesh.geometry.dispose(),this.mesh.material.dispose()}}class V{constructor(e="火警",n={x:-1.8,z:3},t=16777215){const i=new d.dpR,r={"火警":"./textures/tag/fire.png","治安":"./textures/tag/jingcha.png","电力":"./textures/tag/e.png"},o=i.load(r[e]);this.material=new d.xeV({map:o,color:t,transparent:!0,depthTest:!1}),this.mesh=new d.jyi(this.material),this.mesh.position.set(n.x,3.5,n.z),this.fns=[],this.raycaster=new d.iMs,this.mouse=new d.FM8,window.addEventListener("click",(e=>{this.mouse.x=e.clientX/window.innerWidth*2-1,this.mouse.y=-(e.clientY/window.innerHeight*2-1),this.raycaster.setFromCamera(this.mouse,y),e.mesh=this.mesh,e.alarm=this;const n=this.raycaster.intersectObject(this.mesh);n.length>0&&this.fns.forEach((n=>{n(e)}))}))}onClick(e){this.fns.push(e)}remove(){this.mesh.remove(),this.mesh.removeFromParent(),this.mesh.geometry.dispose(),this.mesh.material.dispose()}}function X(){const e=new z.E;e.load("./model/city.glb",(e=>{e.scene.traverse((e=>{if("Mesh"==e.type){console.log(e);const n=new d.vBJ({color:new d.Ilk(790067)});if(e.material=n,M(e),"Layerbuildings"==e.name){const n=new D(e.geometry),t=e.scale.x;n.mesh.scale.set(t,t,t),w.add(n.mesh)}}})),w.add(e.scene)}))}function Q(){X()}const $=new d.SUY;function ee(e){P.update();$.getElapsedTime();requestAnimationFrame(ee),b.render(w,y)}var ne=ee,te=t(8348);const ie=new te.Z;var re=ie,oe={__name:"Scene",props:["eventList"],setup(e){const n=e;let t=(0,c.iH)(null);w.add(y),w.add(L),Q(),(0,r.bv)((()=>{t.value.appendChild(b.domElement),ne()}));const i=[];let o={"火警":(e,n)=>{const t=new Y(1,2,e);t.eventListIndex=n,w.add(t.mesh),i.push(t)},"治安":(e,n)=>{const t=new d.Ilk(Math.random(),Math.random(),Math.random()).getHex(),r=new B(e,t);r.eventListIndex=n,w.add(r.mesh),i.push(r)},"电力":(e,n)=>{const t=new J(2,e);t.eventListIndex=n,w.add(t.mesh),i.push(t)}};return re.on("eventToggle",(e=>{i.forEach((n=>{n.eventListIndex===e?n.mesh.visible=!0:n.mesh.visible=!1}));const t={x:n.eventList[e].position.x/5-10,y:0,z:n.eventList[e].position.y/5-10};h.ZP.to(P.target,{duration:1,x:t.x,y:t.y,z:t.z})})),(0,r.YP)((()=>n.eventList),(e=>{i.forEach((e=>{e.remove()})),n.eventList.forEach(((e,n)=>{const t={x:e.position.x/5-10,z:e.position.y/5-10},r=new V(e.name,t);r.onClick((()=>{re.emit("spriteClick",{event:e,i:n})})),r.eventListIndex=n,i.push(r),w.add(r.mesh),o[e.name]&&o[e.name](t,n)}))})),(e,n)=>((0,r.wg)(),(0,r.iD)("div",{class:"scene",ref_key:"sceneDiv",ref:t},null,512))}};const ae=oe;var se=ae,ue=t(2392),le=t.p+"img/bar.a796a356.svg";const me=e=>((0,r.dD)("data-v-20f3aa5e"),e=e(),(0,r.Cn)(),e),ce={id:"bigScreen"},de=me((()=>(0,r._)("div",{class:"header"},"仿智慧城市管理系统平台",-1))),he={class:"main"},ve={class:"left"},fe={class:"cityEvent"},ge=me((()=>(0,r._)("img",{src:le,class:"icon"},null,-1))),pe=me((()=>(0,r._)("div",{class:"footerBoder"},null,-1))),we={class:"right"},xe={class:"cityEvent list"},ye=me((()=>(0,r._)("h3",null,[(0,r._)("span",null,"事件列表")],-1))),Se=["onClick"],Te=["src"],be={class:"time"};var _e={__name:"BigScreen",props:["dataInfo","eventList"],setup(e){const n=e,i={"电力":t(3886),"火警":t(8957),"治安":t(8169)},o=e=>e.toFixed(0),a=(0,c.iH)(null);re.on("spriteClick",(e=>{a.value=e.i}));const s=e=>{a.value=e,re.emit("eventToggle",e)};return(e,t)=>((0,r.wg)(),(0,r.iD)("div",ce,[de,(0,r._)("div",he,[(0,r._)("div",ve,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.dataInfo,((e,n)=>((0,r.wg)(),(0,r.iD)("div",fe,[(0,r._)("h3",null,[(0,r._)("span",null,(0,ue.zw)(e.name),1)]),(0,r._)("h1",null,[ge,(0,r._)("span",null,(0,ue.zw)(o(e.number))+"（"+(0,ue.zw)(e.unit)+"）",1)]),pe])))),256))]),(0,r._)("div",we,[(0,r._)("div",xe,[ye,(0,r._)("ul",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.eventList,((e,n)=>((0,r.wg)(),(0,r.iD)("li",{class:(0,ue.C_)({active:a.value==n}),onClick:e=>s(n)},[(0,r._)("h1",null,[(0,r._)("div",null,[(0,r._)("img",{class:"icon",src:i[e.name]},null,8,Te),(0,r._)("span",null,(0,ue.zw)(e.name),1)]),(0,r._)("span",be,(0,ue.zw)(e.time),1)]),(0,r._)("p",null,(0,ue.zw)(e.type),1)],10,Se)))),256))])])])])]))}};const Pe=(0,a.Z)(_e,[["__scopeId","data-v-20f3aa5e"]]);var Ce=Pe,Le=t(2942),ze=t.n(Le);function Me(){return ze().get("http://127.0.0.1:4523/mock/804594/api/smartcity/info")}function je(){return ze().get("http://127.0.0.1:4523/mock/804594/api/smartcity/list")}const ke={class:"home"};var Fe={__name:"HomeView",setup(e){const n=(0,c.qj)({iot:{number:0},event:{number:0},power:{number:0},test:{number:0}});(0,r.bv)((async()=>{t(),o(),setInterval((()=>{t(),o()}),1e4)}));const t=async()=>{let e=await Me();for(let t in n)n[t].name=e.data.data[t].name,n[t].unit=e.data.data[t].unit,h.ZP.to(n[t],{number:e.data.data[t].number,duration:1})},i=(0,c.iH)([]),o=async()=>{let e=await je();i.value=e.data.list};return(e,t)=>((0,r.wg)(),(0,r.iD)("div",ke,[(0,r.Wm)(se,{eventList:i.value},null,8,["eventList"]),(0,r.Wm)(Ce,{dataInfo:n,eventList:i.value},null,8,["dataInfo","eventList"])]))}};const He=Fe;var We=He;const Ie=[{path:"/",name:"home",component:We},{path:"/about",name:"about",component:()=>t.e(443).then(t.bind(t,3354))}],Ee=(0,m.p7)({history:(0,m.r5)(),routes:Ie});var Oe=Ee,Be=t(8251),De=(0,Be.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,i.ri)(l).use(De).use(Oe).mount("#app")},4778:function(e){e.exports="varying float vSize;\r\nuniform vec3 uColor;\r\nvoid main(){\r\n    float distanceToCenter = distance(gl_PointCoord,vec2(0.5,0.5));\r\n    float strength = 1.0 - (distanceToCenter*2.0);\r\n\r\n    if(vSize<=0.0){\r\n        gl_FragColor = vec4(1,0,0,0);\r\n    }else{\r\n        gl_FragColor = vec4(uColor,strength);\r\n    }\r\n    \r\n}"},3841:function(e){e.exports="attribute float aSize;\r\n\r\nuniform float uTime;\r\nuniform vec3 uColor;\r\nuniform float uLength;\r\n\r\nvarying float vSize;\r\n\r\nvoid main(){\r\n    vec4 viewPosition = viewMatrix * modelMatrix *vec4(position,1);\r\n    gl_Position = projectionMatrix * viewPosition;\r\n    vSize = (aSize-uTime);\r\n    if(vSize<0.0){\r\n        vSize = vSize + uLength; \r\n    }\r\n    vSize = (vSize-500.0)*0.1;\r\n    \r\n    gl_PointSize = -vSize/viewPosition.z;\r\n}"},4008:function(e){e.exports="varying vec3 vPosition;\r\nvarying vec2 vUv;\r\nuniform vec3 uColor;\r\nuniform float uTime;\r\n\r\nmat2 rotate2d(float _angle){\r\n    return mat2(cos(_angle),-sin(_angle),\r\n                sin(_angle),cos(_angle));\r\n}\r\n\r\n\r\nvoid main(){\r\n    \r\n    vec2 newUv = rotate2d(uTime*6.28) * (vUv-0.5);\r\n    newUv += 0.5;\r\n    float alpha =  1.0 - step(0.5,distance(newUv,vec2(0.5)));\r\n    \r\n    float angle = atan(newUv.x-0.5,newUv.y-0.5);\r\n    float strength = (angle+3.14)/6.28;\r\n    gl_FragColor =vec4(uColor,alpha*strength);\r\n\r\n    \r\n    \r\n}"},6232:function(e){e.exports="varying vec3 vPosition;\r\nvarying vec2 vUv;\r\n\r\nvoid main(){\r\n    vec4 viewPosition = viewMatrix * modelMatrix *vec4(position,1);\r\n    gl_Position = projectionMatrix * viewPosition;\r\n    vPosition = position;\r\n    vUv = uv;\r\n    \r\n}"},1063:function(e){e.exports="varying vec3 vPosition;\r\nuniform float uHeight;\r\nvoid main(){\r\n    // 设置混合的百分比\r\n        float gradMix = (vPosition.y+uHeight/2.0)/uHeight;\r\n      gl_FragColor = vec4(1,1,0,1.0-gradMix);\r\n    \r\n}"},6167:function(e){e.exports="varying vec3 vPosition;\r\n\r\nvoid main(){\r\n    vec4 viewPosition = viewMatrix * modelMatrix *vec4(position,1);\r\n    gl_Position = projectionMatrix * viewPosition;\r\n    vPosition = position;\r\n    \r\n}"},3886:function(e,n,t){"use strict";e.exports=t.p+"img/dianli.652705fd.svg"},8957:function(e,n,t){"use strict";e.exports=t.p+"img/fire.8a72b45b.svg"},8169:function(e,n,t){"use strict";e.exports=t.p+"img/jingcha.a3f91f6c.svg"}},n={};function t(i){var r=n[i];if(void 0!==r)return r.exports;var o=n[i]={exports:{}};return e[i](o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(n,i,r,o){if(!i){var a=1/0;for(m=0;m<e.length;m++){i=e[m][0],r=e[m][1],o=e[m][2];for(var s=!0,u=0;u<i.length;u++)(!1&o||a>=o)&&Object.keys(t.O).every((function(e){return t.O[e](i[u])}))?i.splice(u--,1):(s=!1,o<a&&(a=o));if(s){e.splice(m--,1);var l=r();void 0!==l&&(n=l)}}return n}o=o||0;for(var m=e.length;m>0&&e[m-1][2]>o;m--)e[m]=e[m-1];e[m]=[i,r,o]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(n,i){return t.f[i](e,n),n}),[]))}}(),function(){t.u=function(e){return"js/about.db30b463.js"}}(),function(){t.miniCssF=function(e){}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={},n="threeapp:";t.l=function(i,r,o,a){if(e[i])e[i].push(r);else{var s,u;if(void 0!==o)for(var l=document.getElementsByTagName("script"),m=0;m<l.length;m++){var c=l[m];if(c.getAttribute("src")==i||c.getAttribute("data-webpack")==n+o){s=c;break}}s||(u=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,t.nc&&s.setAttribute("nonce",t.nc),s.setAttribute("data-webpack",n+o),s.src=i),e[i]=[r];var d=function(n,t){s.onerror=s.onload=null,clearTimeout(h);var r=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(t)})),n)return n(t)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/threeJs-demo/"}(),function(){var e={143:0};t.f.j=function(n,i){var r=t.o(e,n)?e[n]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise((function(t,i){r=e[n]=[t,i]}));i.push(r[2]=o);var a=t.p+t.u(n),s=new Error,u=function(i){if(t.o(e,n)&&(r=e[n],0!==r&&(e[n]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+n+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}};t.l(a,u,"chunk-"+n,n)}},t.O.j=function(n){return 0===e[n]};var n=function(n,i){var r,o,a=i[0],s=i[1],u=i[2],l=0;if(a.some((function(n){return 0!==e[n]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(u)var m=u(t)}for(n&&n(i);l<a.length;l++)o=a[l],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(m)},i=self["webpackChunkthreeapp"]=self["webpackChunkthreeapp"]||[];i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i))}();var i=t.O(void 0,[998],(function(){return t(2078)}));i=t.O(i)})();
//# sourceMappingURL=app.3f1810c4.js.map